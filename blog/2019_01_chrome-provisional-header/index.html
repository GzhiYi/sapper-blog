<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <meta content=Mrn4dXO3Z_939geeswIgr2wIpspT6n7X5cX1Tjp69Ko name=google-site-verification> <base href=/ > <link href=global.css rel=stylesheet> <link href=main.css rel=stylesheet> <link href=manifest.json rel=manifest crossorigin=use-credentials> <link href=favicon.png rel=icon type=image/png> <link href=atom-one-light.min.css rel=stylesheet> <script async src=//unpkg.com/valine/dist/Valine.min.js></script> <script async src=https://unpkg.com/ajax-hook@2.0.3/dist/ajaxhook.min.js></script> <link href=client/main.3202803961.css rel=stylesheet> <noscript id=sapper-head-start></noscript><title>chrome出现Caution provisional headers are shown的问题-GzhiYi's blog</title><meta content="chrome出现Caution provisional headers are shown的问题" name=description><meta content="chrome,caution,provisional,headers are shown" name=keywords><noscript id=sapper-head-end></noscript> </head> <body> <div id=sapper> <nav class=svelte-1wr5yce><ul class=svelte-1wr5yce> <li class=svelte-1wr5yce><a href=/ aria-current=blog class=svelte-1wr5yce rel=prefetch>blog</a></ul></nav> <main class=svelte-iwmse4> <div class="svelte-1hcu46h content"><h1>chrome出现Caution provisional headers are shown的问题</h1> <p class="svelte-1hcu46h desc">1/7/2019 <span class="svelte-1hcu46h label">前端</span></p> <p>开发的一个项目出现一个Caution：</p> <pre><code class=language-bash>Caution provisional headers are shown</code></pre> <p>注：这个提示出现在chrome开发者工具的每一个接口请求上。这也只是个警告，还要理它干啥？先看看Google“热搜”的第一个解答： <a href=https://stackoverflow.com/questions/21177387/caution-provisional-headers-are-shown-in-chrome-debugger>“CAUTION: provisional headers are shown” in Chrome debugger</a> “请求被阻塞，东西发不出去，自然没有东西回来”<br>在答者那的例子他说是被adblock拦截了。</p> <h2 id=问题>问题</h2> <p>在项目上线的这段时间内，前期由于使用的少，并未将问题暴露出来，后面使用的人数多了之后，就会出现一个高概率的事情： <strong>个别接口请求一直处于pending状态，数据无法回流</strong><br>这个问题比较严重，后面一直在找解决方案。我的思路历程是：</p> <ol> <li>一开始发现这个问题的时候，有些不可思议，第一次遇到，如果这是一个普遍的问题，为啥又只会出现在个别接口（非固定的个别接口）？</li> <li>调试工具出现<code>provisional headers are shown</code>的警告，瞄准这个警告入手。找到了大量相关的问题描述和方法，在前端这边的处理都未解决。在拦截器修改头，在<code>net-internals</code>抓起日志等就差在每个请求后加上时间戳了（怀疑是前端缓存cache出现异常）。</li> <li>开始怀疑是后端的问题。与后端商量后，在日志打印那发现每一个请求返回都在几毫秒内。当然这个好像没有什么参考性，因为前端貌似这边请求并未成功发出。</li> <li>发现除chrome默认模式外，其它浏览器比如firefox、Edge都没这个问题。甚至在chrome无痕模式也没有这个问题。这时候觉得解决问题比找到原因更重要了（因为已经上线了）。</li> <li>经过后端前端的协调与商量，发现这大概率是因为前后端跨域而出现的问题。</li> </ol> <h2 id=解决>解决</h2> <p><strong>设置请求接口与静态文件处于同源状态（需要nginx配置），警告消失，经过一段时间观察，问题解决。</strong></p> </div> <div class=my-8 id=vcomments></div> </main></div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,(function(a){return {post:{title:"2019\u002F01\u002Fchrome-provisional-header.md",path:"2019\u002F01\u002Fchrome-provisional-header",slug:"2019_01_chrome-provisional-header",html:"\u003Cp\u003E开发的一个项目出现一个Caution：\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-bash\"\u003ECaution provisional headers are shown\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E注：这个提示出现在chrome开发者工具的每一个接口请求上。这也只是个警告，还要理它干啥？先看看Google“热搜”的第一个解答：\n\u003Ca href=\"https:\u002F\u002Fstackoverflow.com\u002Fquestions\u002F21177387\u002Fcaution-provisional-headers-are-shown-in-chrome-debugger\"\u003E“CAUTION: provisional headers are shown” in Chrome debugger\u003C\u002Fa\u003E\n“请求被阻塞，东西发不出去，自然没有东西回来”\u003Cbr\u003E在答者那的例子他说是被adblock拦截了。\u003C\u002Fp\u003E\n\u003Ch2 id=\"问题\"\u003E问题\u003C\u002Fh2\u003E\n\u003Cp\u003E在项目上线的这段时间内，前期由于使用的少，并未将问题暴露出来，后面使用的人数多了之后，就会出现一个高概率的事情：\n\u003Cstrong\u003E个别接口请求一直处于pending状态，数据无法回流\u003C\u002Fstrong\u003E\u003Cbr\u003E这个问题比较严重，后面一直在找解决方案。我的思路历程是：\u003C\u002Fp\u003E\n\u003Col\u003E\n\u003Cli\u003E一开始发现这个问题的时候，有些不可思议，第一次遇到，如果这是一个普遍的问题，为啥又只会出现在个别接口（非固定的个别接口）？\u003C\u002Fli\u003E\n\u003Cli\u003E调试工具出现\u003Ccode\u003Eprovisional headers are shown\u003C\u002Fcode\u003E的警告，瞄准这个警告入手。找到了大量相关的问题描述和方法，在前端这边的处理都未解决。在拦截器修改头，在\u003Ccode\u003Enet-internals\u003C\u002Fcode\u003E抓起日志等就差在每个请求后加上时间戳了（怀疑是前端缓存cache出现异常）。\u003C\u002Fli\u003E\n\u003Cli\u003E开始怀疑是后端的问题。与后端商量后，在日志打印那发现每一个请求返回都在几毫秒内。当然这个好像没有什么参考性，因为前端貌似这边请求并未成功发出。\u003C\u002Fli\u003E\n\u003Cli\u003E发现除chrome默认模式外，其它浏览器比如firefox、Edge都没这个问题。甚至在chrome无痕模式也没有这个问题。这时候觉得解决问题比找到原因更重要了（因为已经上线了）。\u003C\u002Fli\u003E\n\u003Cli\u003E经过后端前端的协调与商量，发现这大概率是因为前后端跨域而出现的问题。\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Ch2 id=\"解决\"\u003E解决\u003C\u002Fh2\u003E\n\u003Cp\u003E\u003Cstrong\u003E设置请求接口与静态文件处于同源状态（需要nginx配置），警告消失，经过一段时间观察，问题解决。\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n",fmData:{attributes:{title:a,description:a,keywords:"chrome,caution,provisional,headers are shown",labels:["前端"],date:"2019-01-07T00:00:00.000Z"},body:"开发的一个项目出现一个Caution：\n```bash\nCaution provisional headers are shown\n```\n注：这个提示出现在chrome开发者工具的每一个接口请求上。这也只是个警告，还要理它干啥？先看看Google“热搜”的第一个解答：\n[“CAUTION: provisional headers are shown” in Chrome debugger](https:\u002F\u002Fstackoverflow.com\u002Fquestions\u002F21177387\u002Fcaution-provisional-headers-are-shown-in-chrome-debugger)\n“请求被阻塞，东西发不出去，自然没有东西回来”  \n在答者那的例子他说是被adblock拦截了。\n\n## 问题\n\n在项目上线的这段时间内，前期由于使用的少，并未将问题暴露出来，后面使用的人数多了之后，就会出现一个高概率的事情：\n**个别接口请求一直处于pending状态，数据无法回流**  \n这个问题比较严重，后面一直在找解决方案。我的思路历程是：\n1. 一开始发现这个问题的时候，有些不可思议，第一次遇到，如果这是一个普遍的问题，为啥又只会出现在个别接口（非固定的个别接口）？\n2. 调试工具出现`provisional headers are shown`的警告，瞄准这个警告入手。找到了大量相关的问题描述和方法，在前端这边的处理都未解决。在拦截器修改头，在`net-internals`抓起日志等就差在每个请求后加上时间戳了（怀疑是前端缓存cache出现异常）。\n3. 开始怀疑是后端的问题。与后端商量后，在日志打印那发现每一个请求返回都在几毫秒内。当然这个好像没有什么参考性，因为前端貌似这边请求并未成功发出。\n4. 发现除chrome默认模式外，其它浏览器比如firefox、Edge都没这个问题。甚至在chrome无痕模式也没有这个问题。这时候觉得解决问题比找到原因更重要了（因为已经上线了）。\n5. 经过后端前端的协调与商量，发现这大概率是因为前后端跨域而出现的问题。\n\n## 解决\n\n**设置请求接口与静态文件处于同源状态（需要nginx配置），警告消失，经过一段时间观察，问题解决。**",bodyBegin:9,frontmatter:"title: chrome出现Caution provisional headers are shown的问题\ndescription: chrome出现Caution provisional headers are shown的问题\nkeywords: chrome,caution,provisional,headers are shown\nlabels: ['前端']\ndate: 2019-01-07"}}}}("chrome出现Caution provisional headers are shown的问题"))]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');(function(){try{eval("async function x(){}");var main="/client/client.19b6d283.js"}catch(e){main="/client/legacy/client.4e6474e3.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@1.0.1.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-170295070-1"></script> <script> window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-170295070-1'); </script> 