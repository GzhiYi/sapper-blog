{"title":"分离小程序环境","description":"官方文档很模糊，搜索到了几条关于小程序环境分离的问题，大部分吐槽官方怎么没有一个好的办法分离开发和生产环境。","keywords":"小程序,环境,分离,云开发","labels":["小程序"],"date":"2019-09-08","path":"2019/09/mp-env-seperate.md","slug":"2019_09_mp-env-seperate","html":"<p>官方文档很模糊，搜索到了几条关于小程序环境分离的问题，大部分吐槽官方怎么没有一个好的办法分离开发和生产环境。</p>\n<h2 id=\"分离方式\">分离方式</h2>\n<ol>\n<li>云函数在调用的时候指定环境，依据云函数所在的环境进行动态设置。</li>\n</ol>\n<pre><code class=\"language-javascript\">const wxContext = cloud<span class=\"hljs-selector-class\">.getWXContext</span>()\n  cloud<span class=\"hljs-selector-class\">.updateConfig</span>({\n    env: wxContext<span class=\"hljs-selector-class\">.ENV</span>\n  })\n  <span class=\"hljs-comment\">// 初始化数据库</span>\n  const db = cloud<span class=\"hljs-selector-class\">.database</span>({\n    env: wxContext<span class=\"hljs-selector-class\">.ENV</span>\n  })\n</code></pre>\n<ol start=\"2\">\n<li>小程序端起到起立环境的主要作用。在appjs中。</li>\n</ol>\n<pre><code class=\"language-javascript\">     wx.cloud.init({\n        traceUser: true,\n        env: <span class=\"hljs-string\">&#x27;release-wifo3&#x27;</span>, <span class=\"hljs-regexp\">//</span> 测试环境\n        <span class=\"hljs-regexp\">//</span> env: <span class=\"hljs-string\">&#x27;dandan-zdm86&#x27;</span> <span class=\"hljs-regexp\">//</span> 正式环境\n      })\n</code></pre>\n<p>预览小程序的时候开启测试环境的env，在部署上线发布的时候再切换为正式环境。</p>\n"}