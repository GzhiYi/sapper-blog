{"title":"2019/09/mp-env-seperate.md","path":"2019/09/mp-env-seperate","slug":"2019_09_mp-env-seperate","html":"<p>官方文档很模糊，搜索到了几条关于小程序环境分离的问题，大部分吐槽官方怎么没有一个好的办法分离开发和生产环境。</p>\n<h2 id=\"分离方式\">分离方式</h2>\n<ol>\n<li>云函数在调用的时候指定环境，依据云函数所在的环境进行动态设置。</li>\n</ol>\n<pre><code class=\"language-javascript\"><span class=\"hljs-keyword\">const</span> wxContext = cloud.getWXContext()\n  cloud.updateConfig({\n    <span class=\"hljs-attr\">env</span>: wxContext.ENV\n  })\n  <span class=\"hljs-comment\">// 初始化数据库</span>\n  <span class=\"hljs-keyword\">const</span> db = cloud.database({\n    <span class=\"hljs-attr\">env</span>: wxContext.ENV\n  })</code></pre>\n<ol start=\"2\">\n<li>小程序端起到起立环境的主要作用。在appjs中。</li>\n</ol>\n<pre><code class=\"language-javascript\">     wx.cloud.init({\n        <span class=\"hljs-attr\">traceUser</span>: <span class=\"hljs-literal\">true</span>,\n        <span class=\"hljs-attr\">env</span>: <span class=\"hljs-string\">'release-wifo3'</span>, <span class=\"hljs-comment\">// 测试环境</span>\n        <span class=\"hljs-comment\">// env: 'dandan-zdm86' // 正式环境</span>\n      })</code></pre>\n<p>预览小程序的时候开启测试环境的env，在部署上线发布的时候再切换为正式环境。</p>\n","fmData":{"attributes":{"title":"分离小程序环境","description":"官方文档很模糊，搜索到了几条关于小程序环境分离的问题，大部分吐槽官方怎么没有一个好的办法分离开发和生产环境。","keywords":"小程序,环境,分离,云开发","labels":["小程序"],"date":"2019-09-08T00:00:00.000Z"},"body":"官方文档很模糊，搜索到了几条关于小程序环境分离的问题，大部分吐槽官方怎么没有一个好的办法分离开发和生产环境。\n\n## 分离方式\n\n1. 云函数在调用的时候指定环境，依据云函数所在的环境进行动态设置。\n\n```javascript\nconst wxContext = cloud.getWXContext()\n  cloud.updateConfig({\n    env: wxContext.ENV\n  })\n  // 初始化数据库\n  const db = cloud.database({\n    env: wxContext.ENV\n  })\n```\n\n2. 小程序端起到起立环境的主要作用。在appjs中。\n\n```javascript\n     wx.cloud.init({\n        traceUser: true,\n        env: 'release-wifo3', // 测试环境\n        // env: 'dandan-zdm86' // 正式环境\n      })\n```\n预览小程序的时候开启测试环境的env，在部署上线发布的时候再切换为正式环境。","bodyBegin":9,"frontmatter":"title: 分离小程序环境\ndescription: 官方文档很模糊，搜索到了几条关于小程序环境分离的问题，大部分吐槽官方怎么没有一个好的办法分离开发和生产环境。\nkeywords: 小程序,环境,分离,云开发\nlabels: ['小程序']\ndate: 2019-09-08"}}